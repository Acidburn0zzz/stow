How to make a new release of GNU Stow
=====================================

  - Ensure NEWS contains the latest changes.

  - Ensure configure.ac contains the new version number.

  - Check CPAN distribution will work via Module::Build:

      - Run ./configure && make to generate stow, chkstow, and lib/Stow.pm
        (N.B. the CPAN distribution will contain these files, whereas
        the GNU distribution will not.)
      - Run perl Build.PL.
      - Run ./Build test
      - Run ./Build install
      - Run ./Build distcheck
      - Run ./Build distmeta and check META.* have the new version number.

  - Ensure all changes are committed to git.

  - Run `rm ChangeLog' to ensure it will get rebuilt.

  - Run make distcheck and ensure that everything looks good.
    It should generate the distribution files for you.

  - Tag the current git HEAD with the new version number:

      git tag v7.8.9

  - Push HEAD and tag to savannah

      git push
      git push --tags

  - Regenerate the documentation for the website:

      # First check out texinfo CVS repository via:
      # cvs -z3 -d:pserver:anonymous@cvs.savannah.gnu.org:/sources/texinfo co texinfo

      # and stow-web CVS repository via the instructions here:
      # https://savannah.gnu.org/cvs/?group=stow

      # Set paths:
      stow_repo=/path/to/stow/git/repo
      stow_web_repo=/path/to/stow-web/CVS/working/dir
      texinfo_repo=/path/to/texinfo/git/repo

      cd $stow_repo
      export GENDOCS_TEMPLATE_DIR=$texinfo_repo/util
      $texinfo_repo/util/gendocs.sh \
          -s doc/stow.texi \
          -o $stow_web_repo/manual \
          --email bug-stow@gnu.org \
          stow "GNU Stow manual"

      cd $stow_web_repo
      # Check that the changes look OK
      cvs diff
      # Then commit
      cvs commit

  - Run ./Build dist

  - Upload the resulting Stow-v7.8.9.tar.gz to CPAN via https://pause.perl.org/

  - Upload to ftp.gnu.org.  This is easiest using gnupload:

      - git clone git://git.savannah.gnu.org/gnulib.git
      - Copy gnulib/build-aux/gnupload to somewhere on your $PATH
      - Run gnupload --to ftp.gnu.org:stow --symlink-regex stow-7.8.9.tar.*

  - Send release announcements to 

      - info-stow@gnu.org
      - stow-devel@gnu.org
      - info-gnu@gnu.org
      - https://savannah.gnu.org/news/?group=stow

    See http://www.gnu.org/prep/maintain/html_node/Announcements.html for
    more on making release announcements.
